---
description: design doc
globs: 
alwaysApply: false
---
航运管理系统项目需求文档
项目背景与概述
随着航运业务规模和复杂程度的提高，传统的手工管理方式难以及时掌握船舶动态、航线信息和货运状态。航运管理系统的开发旨在利用信息化手段，实现对港口、船舶、航线、航次和订单等要素的数字化管理，提高运营效率和决策能力。本项目将在学校环境下开发和部署一个基于Spring Boot后端和Vue前端的航运管理系统，通过集成地图服务和AIS船舶自动识别系统数据，实现航运业务全过程的可视化和智能化管理。
系统架构与基础
系统采用前后端分离架构：后端使用Spring Boot结合MyBatis进行业务逻辑和数据持久化，前端采用Vue框架构建交互界面。系统初期将主要使用提供的AIS示例数据和Excel数据（包括港口、船舶及货物运输记录等）进行开发与测试，同时预留接口方便将来接入更多实时数据源。系统支持多语言界面切换设计（例如中英文），方便不同语言背景的用户使用。
系统角色与权限设计
系统采用RBAC（基于角色的访问控制）模型，设定三种用户角色，每种角色拥有不同的功能权限：
•	系统管理员：系统管理员拥有最高权限，可以管理所有模块的数据和用户。例如，管理员可以维护用户账户和角色权限设置，配置系统参数（如运价附加费标准），以及进行全局的数据导入导出和系统配置管理等操作。
•	航运调度员：航运调度员负责日常的航运业务管理，具有对主要业务模块的数据维护权限。该角色可以管理港口和船舶信息，制定航线计划和发布航次安排，处理和跟踪订单运输进度，并查看船舶动态轨迹。航运调度员在订单模块中可以根据系统计算的基础运价调整附加费用，确保运价合理。
•	客户（货主）：客户是指发布货运需求的用户，仅具备有限的访问权限。客户可以在系统中下达货运订单，查看自己的订单状态和运输详情，包括预计运价和船舶当前所处位置等信息。但客户无法修改关键业务数据，主要以查询和跟踪功能为主。
系统通过上述角色划分实现权限控制，确保不同用户只能访问和操作与其职能相关的模块功能。同时系统支持后续新增角色或权限规则的扩展，以适应更复杂的权限需求。
用户管理模块
用户管理模块用于维护系统用户账户信息及其角色分配。系统管理员通过该模块可以创建、修改、删除用户账户，并设置用户的角色与权限。主要功能包括：
•	用户信息管理：记录用户的基本信息（用户名、密码、邮箱等），支持密码重置和账户状态启用/禁用。
•	角色分配：为每个用户指定预定义的角色（管理员、航运调度员或客户），决定其可访问的功能模块。系统支持一个用户对应单一角色，在后续扩展时可考虑一人多角色的情况。
•	权限控制：结合登录认证机制，系统在各模块功能入口检查用户角色，决定是否授予操作权限。确保敏感操作（如删除数据、调整费用）仅由有权限的角色执行。
该模块还将配合系统的多语言设计，提供本地化的用户界面文本，以及基本的安全要求（如密码加密存储、登陆失败锁定策略等），保障用户账户安全。
港口管理模块
港口管理模块用于维护全球或区域内的港口基本信息，为航线规划和运力调度提供数据支持。主要功能包括：
•	港口信息维护：记录港口名称（中英文）、所属国家/地区、港口代码（如UN/LOCODE）等基本资料。管理员或航运调度员可以新增、编辑或删除港口信息。
•	地理位置信息：针对每个港口，系统存储其地理坐标（经度、纬度）。这些坐标用于航线距离计算和地图可视化展示。初始港口数据可从提供的Excel参考数据导入，包括若干典型港口及其经纬度。
•	港口查询：提供港口列表和搜索功能，可以按名称、国家等条件检索港口，并查看详细信息。方便在定义航线或创建订单时快速选择起运港和目的港。
•	数据扩充机制：系统预留数据导入接口，可批量导入更多港口数据。当需要支持更多航区或全球港口时，可通过模板批量上传扩充港口库。
港口管理模块确保航线与订单所涉及的港口数据完整准确。后续扩展中，可引入第三方港口数据库接口，实现港口信息的自动更新。
船舶管理模块
船舶管理模块用于维护公司自有或合作承运方的船舶基本档案信息，并为AIS动态数据对接做好准备。主要功能包括：
•	船舶信息维护：记录船舶名称、船舶类型（如散货船、集装箱船等，支持中英文类别名称）、船籍、吨位（GRT/DWT）等基本信息。管理员和航运调度员可以新增、编辑、删除船舶档案。
•	唯一标识码：每艘船舶记录关联船舶的唯一识别码，如 MMSI（海事移动业务标识）或IMO编号。这些字段用于与AIS数据联动，实现船舶动态位置的追踪。系统数据模型已针对AIS需求进行了字段扩充，使每条船舶记录都能对应实时数据源。
•	船舶状态字段：预留船舶的当前状态字段，如当前航速、吃水深度、载货情况等。虽然静态档案中不实时更新这些值，但在集成AIS动态数据后，可通过接口更新船舶状态并存储历史状态信息。
•	船舶列表与查询：支持按照船名、类型等条件查询船舶档案。调度员可通过搜索快速定位特定船舶，查看其规格和识别码信息，以便在制定航次计划时选择合适船舶。
通过该模块，系统将船舶的静态信息与动态数据接口关联，为后续船舶跟踪和轨迹回放功能打下基础。在未来接入实时AIS数据后，本模块将自动更新船舶位置和状态相关字段，实现静动态信息融合。
航线管理模块
航线管理模块用于规划和维护航运线路信息，是航次安排和运价计算的基础。主要功能包括：
•	航线定义：由航运调度员制定航线，确定起始港和目的港展，支持多段经停。系统提供港口下拉选择和搜索功能，方便选择已维护的港口。每条航线赋予唯一编号和名称以便识别。
•	自动计算航程距离：系统集成地图API服务，基于起点港和终点港的经纬度自动计算直线航程距离。选用高德地图API作为地图服务提供方，通过其坐标计算功能获取两港间距离。计算结果以公里为单位存储，同时支持将距离换算为海里以满足航运习惯（1海里约等于1.852公里）。航线保存时自动记录该距离.
•	航线可视化：借助地图API，系统支持在前端页面上直观展示航线。用户选择某条航线时，可在嵌入的地图上显示起点港和终点港的位置标注，并绘制连线代表航程路径，帮助用户了解地理走向和距离远近。
•	航线查询与维护：提供航线列表查看、搜索和分类筛选功能。调度员可以按名称、起终点等条件检索已定义航线，查看其详细信息（起止港、距离等）。管理员和调度员可对航线进行编辑（修改名称、经停港等）或删除废弃航线。
航线管理模块确保所有运输任务都有规范定义的线路可循，并通过自动距离计算和可视化降低人工出错，提高规划效率。后期若需要复杂航线计算（如考虑航路绕行、航道限制等），可进一步扩展地图服务的路径规划API功能。
航次管理模块
航次管理模块扩展自航线管理模块，当一个航线确定之后，航次将会自动生成，航运调度员也可以进行航次的增删改查，主要功能包括：
•	航次计划制定：当航运调度员设置好航线以及航线的固定时间后，系统将根据航线的信息自动生成航次，并设定出发日期和预计到达日期等数据，并且根据选定航线的航程距离和船舶航速，辅助计算预计航行时间，供调度员参考调整出发或到港时间。
•	航程距离引用：每个航次自动关联其所选航线的航程距离数据。若有特殊绕航情况，调度员也可手动调整航次距离。系统使用该距离参与后续运价计算和航行时长估算。
•	航次状态跟踪：记录航次的当前状态（未开始、进行中、已完成等）以及关键时间节点（实际开航时间、离港时间、到港时间）。当接入AIS实时数据后，系统可以根据船舶位置变化自动更新航次状态（例如船舶离港后状态置为“进行中”，到达目的港附近则置为“即将抵港”或“已完成”）。
•	航次信息查看：提供航次列表及详情页面，可按照船舶、航线、时间范围等筛选查询。调度员可查看单次航行的执行船舶、运载货物概况、距离和用时、以及关联订单等信息。客户也可在其订单详情中查看对应航次的状态和预计到达时间。
通过航次管理模块，系统将航线规划与实际运输执行衔接起来，实现对每一次具体运输任务的全过程跟踪。该模块与AIS数据联动后，将能更加实时地反映航次进展。
订单管理模块
订单管理模块负责货运订单的创建与跟踪，涵盖运价估算功能，方便业务人员和客户了解运输费用。主要功能包括：
•	订单创建与维护：客户可以在线提交货运订单请求，填写货物信息（名称、类型、重量、体积等）、起始港和目的港、加急或普通的速度需求，加急的需求将会得到系统的优先调度。调度员收到订单后可进行审核和确认，分配船舶和航次执行。系统支持对订单的编辑修改和状态更新（如已确认、运输中、已送达）。
•	运价计算：系统为每笔订单自动生成基础运价参考值。运价计算综合考虑运输距离、货物重量和类别等因素。系统针对特定货物类别，应用对应的费率调整系数（如危险品可能费率上浮）。该基础运价在订单创建或确认时自动给出，供业务人员参考。
•	附加费用管理：系统允许管理员为订单添加和调整附加费用项。附加费用包括但不限于危险品附加费、旺季或淡季的季节性调整费、燃油附加费等。管理员可根据实际情况在订单中增减这些费用条目，最终生成订单的总运费报价。所有费用计算规则将在系统后台配置，确保计算透明且可维护。
•	订单跟踪：客户和调度员均可查看订单的当前状态和详细信息。订单详情页面展示货物内容、选定航次、预计/实际发货与到达时间、运价明细（基础运价+各项附加费用）、以及运输过程中的状态更新（如“已装船”、“运输中”、“已到港”）。客户可通过该页面了解自己的货物运输进展。
•	订单历史与查询：提供订单列表查询和历史归档功能。用户可以根据时间范围、状态、起止港等条件搜索订单记录。系统保存每笔订单的操作日志，方便管理员审计和追踪问题订单。
订单管理模块引入自动运价计算功能，大大提高了报价效率并减少人工计算误差。通过管理员对附加费用的管控，也保证了运价策略的灵活性。未来系统接入第三方物流平台接口后，可实现订单信息的共享和更广泛的货运调度协同。
地图API集成模块
地图API集成模块为系统提供地理信息服务支撑，实现对港口、航线和船舶位置的可视化展现，并提供距离测算功能。本项目在调研百度地图、高德地图、腾讯位置服务等主流地图API后，选择集成高德地图API，主要原因包括其开发文档完善、距离计算精度高及每日免费调用额度充足，适合学校项目使用。地图服务集成主要实现以下功能：
•	航程距离计算：通过高德地图提供的Web服务或算法库，根据两地经纬度计算直线距离。系统后端或前端调用相应接口获取距离数据，用于航线和航次模块的“自动计算航程距离”功能。为确保结果准确，系统考虑使用高德提供的distance接口或GIS算法函数计算大圆距离（地球表面两点最短路径）。
•	港口与航线可视化：系统前端嵌入高德互动地图组件，显示港口分布和航线走向。在港口管理页面，可看到各港口地理位置标记；在航线管理或航次详情页面，地图上绘制连接起讫港的直线路径。用户可以放大缩小地图查看详情，从而更直观理解航运路线。
•	船舶轨迹与位置显示：结合AIS动态数据，在地图上绘制船舶历史轨迹和当前所在位置。地图API支持动态添加点标记和路径线条，系统利用这些功能在“船舶轨迹回放”页面绘制船舶移动路线，在“当前状态查询”页面显示船舶的实时位置标记以及相关信息（速度、方向）。
•	单位换算支持：地图相关界面提供距离单位切换功能。用户可以选择以公里(KM)或海里(NM)为单位查看距离信息。系统默认内部计算使用公里制，但在显示时针对航运领域习惯可自动换算为海里（1海里=1.852公里）。这种单位换算保证了系统在专业领域使用时的友好性。
通过地图API的深度集成，系统实现了从数据到地理的直观呈现，为用户提供强大的空间信息支撑。在后续开发中，可进一步利用地图API的高级功能（如路径规划、实时交通天气信息）丰富系统的智能决策支持。
AIS数据与船舶动态监控模块
AIS数据与船舶动态监控模块专注于利用船舶自动识别系统（Automatic Identification System，AIS）的动态数据来跟踪船舶位置和状态，提升系统对航运过程的实时监控能力。主要功能和设计如下：
•	AIS数据接入：系统预留AIS数据接口，可以对接第三方AIS数据源或平台API，以获取船舶的位置、航速、航向等实时信息。在当前开发环境下，系统以提供的AIS样例数据表作为模拟输入，包括字段：MMSI、经度、纬度、时间戳、航速、航向等。当实际部署时，可通过调用实时AISAPI或导入AIS数据文件来更新船舶动态信息。
•	船舶当前状态查询：提供“当前状态查询”页面，允许用户按船舶名称或编号检索特定船舶的最新动态数据。页面将显示该船舶最近一次报告的位置坐标（通过地图标记显示）、航行状态（如航行中/锚泊）、实时航速和航向等信息。调度员利用此功能可掌握船舶实时位置，从而对航运计划作出及时调整；客户也可通过关联订单查看所载货物船舶的当前位置，了解运输进度。
•	船舶轨迹回放（待定）：系统提供“船舶轨迹回放”功能，用户可选择某艘船舶并指定时间范围，系统将调取该时段内的AIS历史数据并在地图上按时间序列绘制船舶移动轨迹。轨迹回放页面支持播放控制（开始、暂停、加速），以动画形式展示船舶在所选时间段的航行路线及速度变化。该功能帮助管理员和调度员事后分析航行路线选择、绕行情况以及停留时间，以评估航次执行效率和航行安全。
•	数据存储与处理：对于接入的AIS动态数据，系统在本地数据库中建立存储机制，以保存关键的历史轨迹点。考虑到AIS数据量巨大，系统设计将数据按时间和船舶分片存储，并提供归档策略（如定期清理或备份过旧数据），以平衡数据完整性和存储成本。
通过AIS动态监控模块，航运管理系统能够实现对船舶运行情况的即时把控和回顾分析。这不仅提高了系统的实用性，也为将来与更大型海事交通管理系统对接做好了准备。
系统扩展性与未来规划
本系统在设计时充分考虑了未来扩展需求，确保具备良好的伸缩性和兼容性：
•	实时AIS数据对接：虽然当前系统以样例数据形式模拟AIS动态，但未来可以无缝对接实时AIS数据服务。通过调用海事数据提供商的API，系统可获取全球船舶的实时位置和状态，拓展监控范围。同时，系统设计了异步数据更新机制以处理高频的AIS数据刷新，保证实时数据的处理性能。
•	更丰富的港口与航线数据：系统初始港口和航线数据有限，但数据库结构支持导入全球范围内的港口资料和海运航线。未来可集成公共港口数据库或行业数据源，自动更新港口坐标、新增航线航道信息等，以适应更大范围的航运管理需求。
•	第三方平台对接：为提升业务协同能力，系统预留与第三方物流平台和航运交易平台对接的可能。例如，可通过API与货主的仓储管理系统、承运人的船队管理系统对接，实现订单和运输状态的数据共享。一旦对接，客户能够通过熟悉的平台获取由本系统提供的实时航运信息，扩大小系统的应用价值。
•	数据模型调整与优化：随着业务扩展，系统的数据模型可以灵活调整。未来若引入新的业务要素（如集装箱管理、码头泊位调度等），可新增相关数据表和字段。目前已有的数据表也可根据行业标准优化，例如增加船舶的IMO号、船舶尺寸参数，货物增加危险品标识、包装类型字段等。数据模型的扩展将遵循低耦合、高内聚原则，尽量减少对现有功能模块的影响。
•	其他改进：系统将继续完善多语言和多单位支持，未来可扩充更多语言包以及自动单位换算配置。性能方面，可考虑引入分布式部署和缓存技术以支撑更大规模的数据并发访问。安全方面，将根据实际部署环境强化用户认证（如支持单点登录、两因素认证）和权限审计，保障系统运行稳定可靠。
综上所述，本航运管理系统在满足当前需求的同时，为未来的升级演进做好准备。通过以上扩展规划的指引，后续开发者可以方便地将新功能和新数据源融入系统，确保系统的实用性和生命力在实际应用中不断增强。


